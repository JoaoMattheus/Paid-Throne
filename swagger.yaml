openapi: 3.0.3
info:
  title: Paid Throne Calculator API
  description: |
    # üöΩ Paid Throne Calculator API
    
    Esta API divertida permite aos usu√°rios descobrir quanto tempo passam no banheiro, quanto "ganham" durante esse tempo, e como se comparam com outros em rankings interativos e divertidos.
    
    ## Funcionalidades
    
    * üí∞ **C√°lculo de ganhos** baseado no tempo de banheiro
    * üìä **Suporte para diferentes tipos de sal√°rio** (hor√°rio, di√°rio, mensal, anual)
    * ‚è∞ **Valida√ß√£o de tempo m√°ximo** de banheiro para sa√∫de
    * üè¢ **Tratamento detalhado de hor√°rios** de trabalho
    * üëë **Sistema de usu√°rios** com valida√ß√µes personalizadas
    
    ## Como usar
    
    1. Envie uma requisi√ß√£o POST para `/v1/calculate` com os dados do usu√°rio
    2. Receba os c√°lculos detalhados de tempo e ganhos
    3. Compare seus resultados com outros usu√°rios!
    
    ## Valida√ß√µes importantes
        - ‚ö†Ô∏è **Valida√ß√£o customizada**: averageBathroomTime √ó numberOfVisitsPerDay ‚â§ 60 minutos/dia
        - üë§ **Username**: @NotBlank, @Size(5-15), @Pattern(apenas letras/n√∫meros)
        - üíµ **Sal√°rio**: @Min(1), @Max(50000) BigDecimal
        - üöΩ **Visitas**: @Min(1), @Max(5) por dia
        - ‚è±Ô∏è **Tempo m√©dio**: @Min(5) minutos por visita
    
  version: 1.0.0
  contact:
    name: Paid Throne Team
    email: contact@paidthrone.com
    url: https://github.com/JoaoMattheus/Paid-Throne
  license:
    name: MIT License
    url: https://choosealicense.com/licenses/mit/

servers:
  - url: http://localhost:8080
    description: Ambiente de desenvolvimento
  - url: https://api.paidthrone.com
    description: Ambiente de produ√ß√£o

tags:
  - name: Bathroom Salary Calculator
    description: Endpoints para calcular ganhos durante o tempo de banheiro
    externalDocs:
      description: Documenta√ß√£o adicional
      url: https://github.com/JoaoMattheus/Paid-Throne/wiki

paths:
  /v1/calculate:
    post:
      tags:
        - Bathroom Salary Calculator
      summary: Calcular ganhos do tempo de banheiro
      description: |
        Calcula quanto dinheiro uma pessoa ganha durante suas pausas para o banheiro com base em seu sal√°rio e tempo gasto.
        
        ### Funcionalidades do c√°lculo:
        - üìä C√°lculo di√°rio, mensal e anual
        - üí∞ Suporte para diferentes tipos de sal√°rio
        - ‚è±Ô∏è An√°lise de percentual do turno de trabalho
        - üè• Valida√ß√µes de sa√∫de (m√°ximo 1h/dia)
        
        ### Tipos de hor√°rio de trabalho suportados:
        - **6x1**: 6 dias trabalhados, 1 de folga (8h/dia)
        - **5x2**: 5 dias trabalhados, 2 de folga (8h/dia) 
        - **4x3**: 4 dias trabalhados, 3 de folga (8h/dia)
        - **12x36**: 12 horas trabalhadas, 36h de folga (12h/dia)
      operationId: calculateBathroomSalary
      requestBody:
        description: Dados do usu√°rio (King) contendo informa√ß√µes salariais e padr√µes de uso do banheiro
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/King'
            examples:
              exemplo_basico:
                summary: Usu√°rio b√°sico - Sal√°rio mensal
                description: Exemplo de um usu√°rio com sal√°rio mensal de R$ 5.000
                value:
                  username: "KingJohn123"
                  averageBathroomTime: 10
                  numberOfVisitsPerDay: 3
                  salary: 5000.00
                  salaryType: "MONTHLY"
                  workSchedule: "FIVE_ON_TWO"
              exemplo_horista:
                summary: Usu√°rio horista - Alta frequ√™ncia
                description: Trabalhador horista que vai mais vezes ao banheiro
                value:
                  username: "WorkerBee99"
                  averageBathroomTime: 8
                  numberOfVisitsPerDay: 4
                  salary: 25.50
                  salaryType: "HOURLY"
                  workSchedule: "SIX_ON_ONE"
              exemplo_executivo:
                summary: Executivo - Sal√°rio alto
                description: Executivo com sal√°rio alto e menos tempo no banheiro
                value:
                  username: "CEO_Boss"
                  averageBathroomTime: 5
                  numberOfVisitsPerDay: 2
                  salary: 25000.00
                  salaryType: "MONTHLY"
                  workSchedule: "FIVE_ON_TWO"
              exemplo_limite_maximo:
                summary: No limite - M√°ximo permitido
                description: Usu√°rio no limite m√°ximo de tempo permitido
                value:
                  username: "BathroomKing"
                  averageBathroomTime: 12
                  numberOfVisitsPerDay: 5
                  salary: 3000.00
                  salaryType: "MONTHLY"
                  workSchedule: "FOUR_ON_THREE"
      responses:
        '200':
          description: ‚úÖ C√°lculo realizado com sucesso
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/KingCalculateResponse'
              examples:
                calculo_sucesso:
                  summary: C√°lculo bem-sucedido
                  description: Exemplo de resposta com todos os c√°lculos
                  value:
                    username: "KingJohn123"
                    dailyMinutesSpent: 30
                    monthlyMinutesSpent: 600
                    yearlyMinutesSpent: 7200
                    dailyEarnings: 25.00
                    monthlyEarnings: 500.00
                    yearlyEarnings: 6000.00
                    dailyPercentageOfShift: 6.25
                calculo_executivo:
                  summary: C√°lculo para executivo
                  description: Exemplo com sal√°rio alto
                  value:
                    username: "CEO_Boss"
                    dailyMinutesSpent: 10
                    monthlyMinutesSpent: 200
                    yearlyMinutesSpent: 2400
                    dailyEarnings: 104.17
                    monthlyEarnings: 2083.33
                    yearlyEarnings: 25000.00
                    dailyPercentageOfShift: 2.08
        '400':
          description: ‚ùå Entrada inv√°lida - Erros de valida√ß√£o
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'
              examples:
                tempo_excessivo:
                  summary: Tempo total de banheiro excede o m√°ximo
                  description: Erro quando o tempo total ultrapassa 1 hora por dia
                  value:
                    timestamp: "2024-01-15T10:30:00Z"
                    status: 400
                    error: "Bad Request"
                    message: "Vossa majestade deveria caminhar mais! Ficar mais de uma hora no trono n√£o √© saud√°vel!"
                    path: "/v1/calculate"
                    validationErrors:
                      - field: "totalBathroomTime"
                        message: "Tempo total de banheiro n√£o pode exceder 60 minutos por dia"
                username_invalido:
                  summary: Username inv√°lido
                  description: Erro de valida√ß√£o do nome de usu√°rio
                  value:
                    timestamp: "2024-01-15T10:30:00Z"
                    status: 400
                    error: "Bad Request"
                    message: "Validation failed"
                    path: "/v1/calculate"
                    validationErrors:
                      - field: "username"
                        message: "Majestade, seu nome deve ter pelo menos 5 caracteres."
                      - field: "username"
                        message: "Majestade, seu nome n√£o √© esse, n√£o √© mesmo? Ele deve conter apenas letras e n√∫meros."
                salario_invalido:
                  summary: Sal√°rio fora dos limites
                  description: Erro quando sal√°rio est√° fora dos limites permitidos
                  value:
                    timestamp: "2024-01-15T10:30:00Z"
                    status: 400
                    error: "Bad Request"
                    message: "Validation failed"
                    path: "/v1/calculate"
                    validationErrors:
                      - field: "salary"
                        message: "Majestade, voc√™ deve ter um sal√°rio digno de sua realeza."
        '422':
          description: ‚ö†Ô∏è Entidade n√£o process√°vel - Dados inconsistentes
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BusinessError'
              examples:
                dados_inconsistentes:
                  summary: Dados de neg√≥cio inconsistentes
                  description: Erro quando os dados n√£o fazem sentido do ponto de vista de neg√≥cio
                  value:
                    timestamp: "2024-01-15T10:30:00Z"
                    status: 422
                    error: "Unprocessable Entity"
                    message: "Os dados fornecidos s√£o inconsistentes para o c√°lculo"
                    path: "/v1/calculate"
                    details:
                      - "Combina√ß√£o de sal√°rio e hor√°rio de trabalho resulta em valores irreais"
        '500':
          description: üí• Erro interno do servidor
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InternalServerError'
              examples:
                erro_interno:
                  summary: Erro interno do servidor
                  description: Erro inesperado durante o processamento
                  value:
                    timestamp: "2024-01-15T10:30:00Z"
                    status: 500
                    error: "Internal Server Error"
                    message: "Ocorreu um erro inesperado durante o c√°lculo"
                    path: "/v1/calculate"
                    traceId: "abc123def456"

  /actuator/health:
    get:
      tags:
        - Health Check
      summary: Verificar sa√∫de da aplica√ß√£o
      description: Endpoint para verificar se a aplica√ß√£o est√° funcionando corretamente
      operationId: healthCheck
      responses:
        '200':
          description: ‚úÖ Aplica√ß√£o funcionando normalmente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthStatus'
              example:
                status: "UP"
                components:
                  db:
                    status: "UP"
                  diskSpace:
                    status: "UP"
        '503':
          description: ‚ùå Aplica√ß√£o com problemas
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthStatus'
              example:
                status: "DOWN"
                components:
                  db:
                    status: "DOWN"
                    details:
                      error: "Connection refused"

components:
  schemas:
    King:
      type: object
      required:
        - username
        - averageBathroomTime
        - numberOfVisitsPerDay
        - salary
        - salaryType
        - workSchedule
      properties:
        username:
          type: string
          minLength: 5
          maxLength: 15
          pattern: '^[a-zA-Z0-9]+$'
          description: |
            Nome de usu√°rio do Rei (usu√°rio)
            
            **Regras:**
            - Deve ter entre 5 e 15 caracteres
            - Apenas letras e n√∫meros s√£o permitidos
            - N√£o pode conter espa√ßos ou caracteres especiais
          example: "KingJohn123"
        averageBathroomTime:
          type: integer
          minimum: 5
          maximum: 20
          description: |
            Tempo m√©dio gasto no banheiro por visita (em minutos)
            
            **Limites:**
            - M√≠nimo: 5 minutos (para ser realista)
            - M√°ximo: 20 minutos (para manter a sa√∫de)
          example: 10
        numberOfVisitsPerDay:
          type: integer
          minimum: 1
          maximum: 5
          description: |
            N√∫mero de visitas ao banheiro por dia
            
            **Limites:**
            - M√≠nimo: 1 visita por dia
            - M√°ximo: 5 visitas por dia (limite saud√°vel)
          example: 3
        salary:
          type: number
          format: decimal
          minimum: 1
          maximum: 50000
          multipleOf: 0.01
          description: |
            Sal√°rio na moeda local
            
            **Limites:**
            - M√≠nimo: 1 moeda (deve ter algum sal√°rio)
            - M√°ximo: 50.000 moedas (limite do sistema)
            - Precis√£o: 2 casas decimais
          example: 5000.00
        salaryType:
          $ref: '#/components/schemas/SalaryType'
        workSchedule:
          $ref: '#/components/schemas/WorkSchedule'
      example:
        username: "KingJohn123"
        averageBathroomTime: 10
        numberOfVisitsPerDay: 3
        salary: 5000.00
        salaryType: "MONTHLY"
        workSchedule: "FIVE_ON_TWO"

    SalaryType:
      type: string
      enum:
        - HOURLY
        - DAILY
        - MONTHLY
        - YEARLY
      description: |
        Tipo de sal√°rio do usu√°rio
        
        **Op√ß√µes dispon√≠veis:**
        - `HOURLY`: Sal√°rio por hora trabalhada
        - `DAILY`: Sal√°rio por dia trabalhado
        - `MONTHLY`: Sal√°rio mensal fixo
        - `YEARLY`: Sal√°rio anual
      example: "MONTHLY"

    WorkSchedule:
      type: string
      enum:
        - SIX_ON_ONE
        - FIVE_ON_TWO
        - FOUR_ON_THREE
        - TWELVE_ON_THIRTY_SIX
      description: |
        Hor√°rio de trabalho do usu√°rio
        
        **Op√ß√µes dispon√≠veis:**
        - `SIX_ON_ONE`: 6 dias trabalhados, 1 de folga (8h/dia, 26 dias/m√™s)
        - `FIVE_ON_TWO`: 5 dias trabalhados, 2 de folga (8h/dia, 20 dias/m√™s) 
        - `FOUR_ON_THREE`: 4 dias trabalhados, 3 de folga (8h/dia, 16 dias/m√™s)
        - `TWELVE_ON_THIRTY_SIX`: 12h trabalhadas, 36h folga (12h/dia, 12 dias/m√™s)
      example: "FIVE_ON_TWO"

    KingCalculateResponse:
      type: object
      required:
        - username
        - dailyMinutesSpent
        - monthlyMinutesSpent
        - yearlyMinutesSpent
        - dailyEarnings
        - monthlyEarnings
        - yearlyEarnings
        - dailyPercentageOfShift
      properties:
        username:
          type: string
          description: Nome de usu√°rio do Rei (usu√°rio)
          example: "KingJohn123"
        dailyMinutesSpent:
          type: integer
          minimum: 0
          description: Total de minutos gastos no banheiro por dia
          example: 30
        monthlyMinutesSpent:
          type: integer
          minimum: 0
          description: Total de minutos gastos no banheiro por m√™s
          example: 600
        yearlyMinutesSpent:
          type: integer
          minimum: 0
          description: Total de minutos gastos no banheiro por ano
          example: 7200
        dailyEarnings:
          type: number
          format: decimal
          minimum: 0
          multipleOf: 0.01
          description: Valor ganho durante o tempo de banheiro por dia
          example: 25.00
        monthlyEarnings:
          type: number
          format: decimal
          minimum: 0
          multipleOf: 0.01
          description: Valor ganho durante o tempo de banheiro por m√™s
          example: 500.00
        yearlyEarnings:
          type: number
          format: decimal
          minimum: 0
          multipleOf: 0.01
          description: Valor ganho durante o tempo de banheiro por ano
          example: 6000.00
        dailyPercentageOfShift:
          type: number
          format: double
          minimum: 0
          maximum: 100
          description: Percentual do turno de trabalho gasto no banheiro
          example: 6.25
      example:
        username: "KingJohn123"
        dailyMinutesSpent: 30
        monthlyMinutesSpent: 600
        yearlyMinutesSpent: 7200
        dailyEarnings: 25.00
        monthlyEarnings: 500.00
        yearlyEarnings: 6000.00
        dailyPercentageOfShift: 6.25

    ValidationError:
      type: object
      required:
        - timestamp
        - status
        - error
        - message
        - path
      properties:
        timestamp:
          type: string
          format: date-time
          description: Timestamp do erro
          example: "2024-01-15T10:30:00Z"
        status:
          type: integer
          description: C√≥digo de status HTTP
          example: 400
        error:
          type: string
          description: Tipo do erro
          example: "Bad Request"
        message:
          type: string
          description: Mensagem principal do erro
          example: "Validation failed"
        path:
          type: string
          description: Caminho da requisi√ß√£o que causou o erro
          example: "/v1/calculate"
        validationErrors:
          type: array
          description: Lista detalhada dos erros de valida√ß√£o
          items:
            $ref: '#/components/schemas/FieldError'

    FieldError:
      type: object
      required:
        - field
        - message
      properties:
        field:
          type: string
          description: Nome do campo que causou o erro
          example: "username"
        message:
          type: string
          description: Mensagem de erro espec√≠fica do campo
          example: "Majestade, seu nome deve ter pelo menos 5 caracteres."
        rejectedValue:
          description: Valor que foi rejeitado (opcional)
          example: "abc"

    BusinessError:
      type: object
      required:
        - timestamp
        - status
        - error
        - message
        - path
      properties:
        timestamp:
          type: string
          format: date-time
          description: Timestamp do erro
          example: "2024-01-15T10:30:00Z"
        status:
          type: integer
          description: C√≥digo de status HTTP
          example: 422
        error:
          type: string
          description: Tipo do erro
          example: "Unprocessable Entity"
        message:
          type: string
          description: Mensagem principal do erro
          example: "Os dados fornecidos s√£o inconsistentes para o c√°lculo"
        path:
          type: string
          description: Caminho da requisi√ß√£o que causou o erro
          example: "/v1/calculate"
        details:
          type: array
          description: Detalhes adicionais sobre o erro de neg√≥cio
          items:
            type: string
          example:
            - "Combina√ß√£o de sal√°rio e hor√°rio de trabalho resulta em valores irreais"

    InternalServerError:
      type: object
      required:
        - timestamp
        - status
        - error
        - message
        - path
      properties:
        timestamp:
          type: string
          format: date-time
          description: Timestamp do erro
          example: "2024-01-15T10:30:00Z"
        status:
          type: integer
          description: C√≥digo de status HTTP
          example: 500
        error:
          type: string
          description: Tipo do erro
          example: "Internal Server Error"
        message:
          type: string
          description: Mensagem principal do erro
          example: "Ocorreu um erro inesperado durante o c√°lculo"
        path:
          type: string
          description: Caminho da requisi√ß√£o que causou o erro
          example: "/v1/calculate"
        traceId:
          type: string
          description: ID de rastreamento para debugging
          example: "abc123def456"

    HealthStatus:
      type: object
      required:
        - status
      properties:
        status:
          type: string
          enum: [UP, DOWN, OUT_OF_SERVICE, UNKNOWN]
          description: Status geral da aplica√ß√£o
          example: "UP"
        components:
          type: object
          description: Status dos componentes individuais
          additionalProperties:
            type: object
            properties:
              status:
                type: string
                enum: [UP, DOWN, OUT_OF_SERVICE, UNKNOWN]
              details:
                type: object
                description: Detalhes adicionais sobre o componente
          example:
            db:
              status: "UP"
            diskSpace:
              status: "UP"

  examples:
    KingBasico:
      summary: Usu√°rio b√°sico
      description: Exemplo de usu√°rio com configura√ß√µes padr√£o
      value:
        username: "KingJohn123"
        averageBathroomTime: 10
        numberOfVisitsPerDay: 3
        salary: 5000.00
        salaryType: "MONTHLY"
        workSchedule: "FIVE_ON_TWO"

    KingHorista:
      summary: Trabalhador horista
      description: Exemplo de trabalhador com sal√°rio por hora
      value:
        username: "WorkerBee99"
        averageBathroomTime: 8
        numberOfVisitsPerDay: 4
        salary: 25.50
        salaryType: "HOURLY"
        workSchedule: "SIX_ON_ONE"

    KingExecutivo:
      summary: Executivo
      description: Exemplo de executivo com sal√°rio alto
      value:
        username: "CEO_Boss"
        averageBathroomTime: 5
        numberOfVisitsPerDay: 2
        salary: 25000.00
        salaryType: "MONTHLY"
        workSchedule: "FIVE_ON_TWO"

  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: header
      name: X-API-Key
      description: |
        Chave de API para autentica√ß√£o (futura implementa√ß√£o)
        
        **Nota:** Atualmente a API √© p√∫blica, mas futuramente pode requerer autentica√ß√£o para:
        - Rate limiting personalizado
        - Hist√≥rico de c√°lculos
        - Rankings personalizados

# Configura√ß√µes globais
security: []  # API atualmente p√∫blica

# Configura√ß√µes adicionais para ferramentas
x-tagGroups:
  - name: Core API
    tags:
      - Bathroom Salary Calculator
  - name: Monitoring
    tags:
      - Health Check

x-samples-languages:
  - curl
  - javascript
  - python
  - java
  - csharp
